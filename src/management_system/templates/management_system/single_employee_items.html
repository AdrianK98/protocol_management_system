{% extends 'main.html' %}


{% block content %}
<h2>Sprzęt na stanie {{employee}}</h2>
<a class="btn btn-dark float-end me-5" href="{% url 'singleEmployeeProtocols' employee.id %}" role="button">Protokoły</a>




    <div class="container text-center mt-5">
        <div class="row">
          <div class="col"><b>Nazwa sprzętu: </b></div>
          <div class="col"><b>IT: </b></div>
          <div class="col-2"><b>SN: </b></div>
          <div class="col"><b>KK: </b></div>
          <div class="col"></div>
          <div class="col"></div>
          <div class="col-6"></div>

        {% for item in items%}
        <hr>
            <div class="row mt-2">
                <div class="col">{{item.item_name}}</div>
                <div class="col">{{item.item_it}}</div>
                <div class="col-2">{{item.item_sn|default_if_none:""}}</div>
                <div class="col">{{item.item_kk|default_if_none:""}}</div>
                <div class="col"><a class="btn btn-primary" href="{% url 'singleItem' item.id %}" role="button">Wyświetl</a></div>
                <div class="col"><a class="btn btn-danger zdajBtn"  role="button" data-item-id="{{item.id}}">-</a></div>
                <div class="col-6"></div>
                
            </div>
            
        {%endfor%}  
        <hr>

        <form id="returnItemForm" action="{% url 'employeeReturns' employee.id %}" method="post">
            {% csrf_token %}
            <input type="hidden" name="idList" id="idListInput">
            <button type="submit" class="btn btn-danger">Zdaj sprzęt</button>
          </form>
          <a class="btn btn-primary" href="{% url 'newprotocol'  %}?eid={{employee.id}}" role="button">Dodaj sprzęt</a>

    </div>
    <script>
        // Define an empty array to store the IDs
        var idList = [];
        var submitForm = document.getElementById("returnItemForm");
        submitForm.style.display = "none";
        // Function to handle button click
        function handleButtonClick(event) {
            // Get the button element
            var button = event.target;

            // Get the data-item-id attribute value
            var itemId = button.getAttribute("data-item-id");

            // Check if the itemId is already in the idList
            if (!idList.includes(itemId)) {
                // Append the itemId to the idList
                idList.push(itemId);

                // Disable the button
                button.disabled = true;

                // Change the class of the button
                button.className = "btn btn-secondary zdajBtn";
                var idListInput = document.getElementById("idListInput");
                idListInput.value = JSON.stringify(idList);


                submitForm.style.display = "block";



                // Print the updated idList
                console.log(idList);
            }
        }

        // Get all buttons with "zdajBtn" in their class
        var buttons = document.querySelectorAll(".zdajBtn");

        // Attach the handleButtonClick function to each button's click event
        buttons.forEach(function(button) {
            button.addEventListener("click", handleButtonClick);
        });
    </script>




{% endblock content %}